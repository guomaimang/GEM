import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as e,e as a}from"./app.a0f10e93.js";const t={},o=a(`<h1 id="report" tabindex="-1"><a class="header-anchor" href="#report" aria-hidden="true">#</a> Report</h1><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h2><p>In this Project, we commit to do a group project of 5-people called <strong>&quot;GEM&quot;</strong>. We design and implement a mobile computing application using Android platform, especially <strong>Mobile Social Network</strong>, which uses mobile devices to make friends and share photos.</p><p>On one hand, we have applied our knowledge in the course of Mobile Computing - Related concept of <strong>basic Android application development</strong>, <em>mobility management</em>, <strong>location-based services</strong>, and <strong>other security issues</strong>. On the other hand, we practise our programming and software engineering skills using java as well as the <strong>Java</strong> and <strong>Android</strong> development platform.</p><h2 id="computing-model" tabindex="-1"><a class="header-anchor" href="#computing-model" aria-hidden="true">#</a> Computing Model</h2><h3 id="constrains" tabindex="-1"><a class="header-anchor" href="#constrains" aria-hidden="true">#</a> Constrains</h3><p>Mobile computing application designers need to design appropriate models, given the restrictions and constrains of mobile computing environment. These restrictions have a great impact on the design and structure of mobile computing applications. We, the Mobile computing application designers, need to design appropriate models and architectures to organize applications components and specify their relationships. In our project, we assume the following constrains:</p><ol><li>Mobile devices are resource-poor, and <strong>only operating system of Android</strong>.</li><li>Network connectivity is <strong>reliable</strong> in this setting, with <strong>low bandwidth</strong> and <strong>intermittent</strong>.</li><li>Storage resources on server side is unlimited by adopting third-party service (database).</li></ol><h3 id="three-tier-mobile-c-s-model" tabindex="-1"><a class="header-anchor" href="#three-tier-mobile-c-s-model" aria-hidden="true">#</a> Three-tier mobile C/S model</h3><p>Standard C/S model does not work well in mobile environments for several reasons, for example, no support of continuous network connectivity and powerful client ability, and no mobility support. Thus, we adopt the Client/Agent/Server Model (CAS) to support the mobile application.</p><p>For Agent, serving as a deputy of the client on the fixed network. It basically supports two roles:</p><ol><li><strong>Communications between</strong> client and server pass through agent.</li><li>Agent <strong>continuously maintains the client\u2019s presence</strong> on the fixed network.</li><li>Agents will follow the user&#39;s movement but remains unchanged.</li></ol><p>In our project, we mainly use NGINX service as the agent for supporting our application, which is a performance-oriented HTTP server. Compared with Apache and lighttpd, it has the advantages of less memory and higher stability. The functionalities of NGINX adopted in our application are summarized as follows:</p><ol><li><strong>Exchange messages</strong> and queue messages</li><li><strong>Offload</strong> processing operations from client</li><li><strong>Handle disconnection</strong> between client and server</li><li><strong>Optimize transmission</strong> over wireless link</li></ol><p><img src="https://static-file.hjm.red/2022/11/22/642c38428aa59.png" alt="1669106075822.png" loading="lazy"> Figure: Architecture Diagram</p><p>We have use its configuration file in our project, which details of the configuration file are attached in <code>Appendix A</code>. To support the above funtionalities, Nginx has mainly the following 3 implementations:</p><ol><li><strong>Forward proxy:</strong> Multiple clients obtain content from nginx when requesting, so they cannot feel the existence of servers.</li><li><strong>Load balancing:</strong> With the continuous growth of business and the continuous increase of users, one service can no longer meet the system requirements. At this time, server clusters appeared. In a server cluster, Nginx can set <em><strong>uniformly</strong></em> or according to weight the received client requests to all servers in the cluster, to distribute server cluster <em><strong>pressure</strong></em> and ensure the <em><strong>stability</strong></em> of client access.</li><li><strong>Reverse proxy:</strong> Multiple clients obtain content from Nginx when requesting, and the server cannot feel the existence of the clients. This is also to support the functionality of load balancing.</li></ol><p>For service and client side, design and implementation details will be introduced in <code>Section. Client side design</code> and<code> Section. Server side design</code>.</p><p>With Alibaba&#39;s Global acceleration, GEM&#39;s CDN nodes and Agent nodes are located in <strong>almost every city in the world</strong>.</p><p>In our project, the adoption of CAS model has several advantages:</p><ol><li>Some of <strong>client functionalities</strong> are shifted to agent, such as reliable HTTP connection control.</li><li>Agent can <strong>cache some results</strong> to improve performance.</li><li>Multiple user agents in different area, which reduced access latency and enhanced stability of mobile network communications.</li></ol><h2 id="client-side-design" tabindex="-1"><a class="header-anchor" href="#client-side-design" aria-hidden="true">#</a> Client Side Design</h2><p>In this section, we will introduce the overall logic flow and interaction of client and server. Please note that the aim is to provide an <em>overview</em> and details and implementation will be introduced in later sections.</p><h3 id="multi-threaded-and-transaction-driven" tabindex="-1"><a class="header-anchor" href="#multi-threaded-and-transaction-driven" aria-hidden="true">#</a> Multi-threaded and Transaction-driven</h3><p>The Android client is designed with object-oriented and transaction-driven programming in mind. The developer clearly classifies tasks so that UI rendering tasks are done by UI threads and network communication tasks are done by network threads. This implements asynchrony and does not cause unnecessary blocking.</p><h3 id="livedata-with-viewmodel" tabindex="-1"><a class="header-anchor" href="#livedata-with-viewmodel" aria-hidden="true">#</a> LiveData with ViewModel</h3><p>LiveData is a component of Android Jetpack, it has the function of listening to the life cycle to ensure that when the life cycle is active, the observer will be notified of data updates in time. Use LiveData does not need to worry too much about memory leaks, because it will bind LifeCycle (such as Activity) when it is created, when the LifeCycle is destroyed, LiveData will be automatically unbound to it.</p><p>ViewModel is a concept in the MVVM pattern, it is a bridge between View (view) and Model (model) communication. viewModel role and the MVP pattern in the Presenter is very similar, but ViewModel is a good solution to the problem of too many MVP interfaces.</p><h3 id="main-activities" tabindex="-1"><a class="header-anchor" href="#main-activities" aria-hidden="true">#</a> Main Activities</h3><p>After GEM app is opened, the main activities will happen one by one as follows:</p><ol><li><strong>Permission is checked:</strong> Whether user would like application access to certain local files, and there involves 3 types of access check and will be introduced in <code>section. Functionalities</code>.</li><li><strong>Set up 4 navigation views</strong> After permission is granted, local application will automatically set up the views and these involves no access to server side and completely automatically finishes in client side.</li><li><strong>Sep up 4 bottom buttons (Trend, Map, Upload, Profile):</strong> The 4 bottoms are the key functions in this GEM application and their views need to be set initially so that users are able to interact with them in the following.</li><li><strong>Set up database (client side and server side):</strong> On Client side, SQLiteDatabase will be used and on server side, MySQL will be used. In this step, we also assume that server already commences.</li></ol><h4 id="trend-fragment" tabindex="-1"><a class="header-anchor" href="#trend-fragment" aria-hidden="true">#</a> Trend Fragment</h4><p>After initialization, user has 4 options and Trend View is displayed after user clicks on <em><strong>Trend</strong></em>.</p><ul><li><strong>Display Post lists:</strong> View will be created after trend button is clicked and post meta list will be get. To get the post lists on client side, the TrendViewModel on client side will send <strong>HTTP GET</strong> to server, and server will send the <strong>HTTP response</strong> together with the post(JSON) back to client. On server side, records will be <strong>selected by SQL</strong> and server will encapsulate the lists in HTTP response. Finally, posts can be displayed.</li><li><strong>View Post details:</strong> After user click on one specific post, the post details will be shown, including <strong>user name, picture name, post time, message and location.</strong></li></ul><p><img src="https://static-file.hjm.red/2022/11/22/5e3f9fd40fa1c.png" alt="trend.drawio.png" loading="lazy"> Figure. Trend Flow</p><h4 id="map-fragment" tabindex="-1"><a class="header-anchor" href="#map-fragment" aria-hidden="true">#</a> Map Fragment</h4><p>After initialization, user has 4 options and Trend View is displayed after user clicks on <em><strong>Map</strong></em>.</p><ol><li><p><strong>Client side:</strong> Client will set <strong>Javascipt</strong>, set <strong>Dom storage</strong>, set <strong>no cache mode</strong> and send <strong>HTTP request</strong> to get the map information.</p></li><li><p><strong>Server side:</strong> Server will build the <strong>MapBoxModel</strong> and get its HTML format, and finally encasulates it in the <strong>HTTP response</strong> and send back to client, so that Map can be displayed successful on client side.</p></li></ol><p><img src="https://static-file.hjm.red/2022/11/22/eac28ebbd1bc9.png" alt="map.drawio 1.png" loading="lazy"> Figure. Map Flow</p><h4 id="upload-fragment" tabindex="-1"><a class="header-anchor" href="#upload-fragment" aria-hidden="true">#</a> Upload Fragment</h4><p>After initialization, user has 4 options and Trend View is displayed after user clicks on <em><strong>Upload</strong></em>.</p><ol><li><strong>View is created and local database is selected:</strong> After creating <strong>Upload View</strong>, controller on client side will get local user info and check log in, and then check location and update access.</li><li><strong>Grant permission, upload photo and transmission to Bit Map:</strong> Dialog will be prompted and user can click on two options for uploading photo:</li></ol><ul><li><strong>From Album:</strong> Choose photo from album</li><li><strong>From Camera:</strong> Capture photo now</li></ul><p>Please note that only certain permission is granted such that these above functions are able to work. Android will call two different actions called <strong>ACTION_PICK</strong> and <strong>IMAGE_CAPTURE</strong> to get the result of photo and display them through <strong>BitMapModel</strong>, by transmitting photo into Bit Map.</p><ol start="3"><li><p><strong>HTTP Request and HTTP Response and transmission in Base64 String:</strong> After photo is displayed, and click <strong>Upload</strong>, it will be transmited into Base64 string format and encapsulated in HTTP Request and send to server side. Server will reply HTTP Response to show whether upload is successful.</p></li><li><p><strong>View uploading result:</strong> If server replies <strong>&quot;Post Success!&quot;</strong>, then the post is successfully uploaded, otherwise, error message will be displayed.</p></li></ol><p><img src="https://static-file.hjm.red/2022/11/22/0db4b5a57dc2b.png" alt="upload.drawio.png" loading="lazy"> Figure. Post uploading and transmission</p><h4 id="profile-fragment" tabindex="-1"><a class="header-anchor" href="#profile-fragment" aria-hidden="true">#</a> Profile Fragment</h4><p>After initialization, user has 4 options and Trend View is displayed after user clicks on <em><strong>Profile</strong></em>.</p><h5 id="register-flow" tabindex="-1"><a class="header-anchor" href="#register-flow" aria-hidden="true">#</a> Register Flow</h5><p>User needs to register before posting any post. To register, simply put in the user name and password to register. HTTP request will encapsulate the information and send to server, and server will register this record in <strong>MySQL database</strong>. Error message will occur if network is in bad connection.</p><h5 id="log-in-flow" tabindex="-1"><a class="header-anchor" href="#log-in-flow" aria-hidden="true">#</a> Log In Flow</h5><p>User needs to log in after registration, by entering registered user name and password and then clicks &quot;log in&quot;. However, if they have not registered yet, server will check that no record and display error message. Details of the implementation will be introduced in <code>Section. Functionalities</code>.</p><h5 id="view-personal-profile" tabindex="-1"><a class="header-anchor" href="#view-personal-profile" aria-hidden="true">#</a> View personal profile</h5><p>After logging in, a personal profile page will be shown with basic profile information.</p><h5 id="log-out" tabindex="-1"><a class="header-anchor" href="#log-out" aria-hidden="true">#</a> Log out</h5><p>If user presses <strong>Log out</strong>, then they will enter first page of Profile view and log in again.</p><p><img src="https://static-file.hjm.red/2022/11/22/653f6b8cee6b3.png" alt="profile.drawio.png" loading="lazy"> Figure. Profile Flow</p><h3 id="trend-detail-activity" tabindex="-1"><a class="header-anchor" href="#trend-detail-activity" aria-hidden="true">#</a> Trend Detail Activity</h3><p>After main activity, the <strong>TrendDetailActivity</strong> will happen to get lists of post and put them in the Trend View. Basic information of each post includes Location, Time, Message, Poster, and Photo. Client needs to request <strong>HTTP</strong> to Server to get the post stored in <strong>MySQL</strong> and display on client side. Details code implementation will be introduced in later section.</p><p><img src="https://static-file.hjm.red/2022/11/22/e895efe70475f.png" alt="logic_flow.drawio.png" loading="lazy"> Figure. Logic flow of Activities</p><h2 id="details-of-basic-functionalities" tabindex="-1"><a class="header-anchor" href="#details-of-basic-functionalities" aria-hidden="true">#</a> Details of Basic Functionalities</h2><h3 id="local-access" tabindex="-1"><a class="header-anchor" href="#local-access" aria-hidden="true">#</a> Local Access</h3><ol><li><p><strong>Capture photo and record video:</strong> Reject/Allow once also in the background / Allow once and not in the background.</p></li><li><p><strong>Read device location information:</strong> Reject/Allow once also in the background / Allow once and not in the background.</p></li><li><p><strong>Read Local files and photos:</strong> Reject/Allow once also in the background / Allow once and not in the background.</p></li></ol><p>Please note that Unless the user chooses to allow all the time, each time when the application is reopened, the permission request will pop up. If the permissions are not given, some functions of the application will <strong>not</strong> be used.</p><h3 id="time-stamp-format-standardization" tabindex="-1"><a class="header-anchor" href="#time-stamp-format-standardization" aria-hidden="true">#</a> Time Stamp Format Standardization</h3><p>HKT is uniformly used everywhere, and the format is <code>&quot;yyyy-MM-dd hh:mm:ss&quot;</code>.</p><p>For <strong>SQL</strong>, the format is as follows:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> str_to_date<span class="token punctuation">(</span><span class="token string">&#39;08.09.2008 08:09:30&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;%m.%d.%Y %h:%i:%s&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 2008-08-09 08:09:30</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>For <strong>Java</strong>, the format is as follows:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Date</span> dNow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SimpleDateFormat</span> ft <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span> <span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Current time is: &quot;</span> <span class="token operator">+</span> ft<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>dNow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="data-transmission-protocol" tabindex="-1"><a class="header-anchor" href="#data-transmission-protocol" aria-hidden="true">#</a> Data Transmission Protocol</h3><h4 id="register-post" tabindex="-1"><a class="header-anchor" href="#register-post" aria-hidden="true">#</a> Register POST</h4><p>Client will initiates the <strong>HTTP request</strong>, and the format is as follows:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST comp4342.hjm.red:8044/register HTTP/1.1 
Content-Type: application/json;charset=utf-8

{&quot;user&quot;: &quot;hanjiaming&quot;, 
 &quot;password&quot;: &quot;123456&quot;,
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Server will send <strong>HTTP response</strong>, and the example format is as follows:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;statue&quot;</span><span class="token operator">:</span><span class="token string">&quot;Fail&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span><span class="token string">&quot;username exist.&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="log-in-post" tabindex="-1"><a class="header-anchor" href="#log-in-post" aria-hidden="true">#</a> Log In POST</h4><p>Client will initiates the <em><strong>HTTP request</strong></em>, and the format is as follows:</p><div class="language-ht ext-ht line-numbers-mode"><pre class="language-ht"><code>POST comp4342.hjm.red:8044 HTTP/1.1 
Content-Type: application/json;charset=utf-8

{&quot;user&quot;: &quot;hanjiaming&quot;, 
 &quot;password&quot;: &quot;123456&quot;,
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Server will send <em><strong>HTTP response</strong></em>, and the format is as follows:</p><div class="language-ht ext-ht line-numbers-mode"><pre class="language-ht"><code>{
    &quot;statue&quot;:&quot;Fail&quot;,
    &quot;message&quot;:&quot;No this User&quot;,
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The fail reason is that this user is not registed yet.After successful log in, the code will return 0.</p><h4 id="trend-get" tabindex="-1"><a class="header-anchor" href="#trend-get" aria-hidden="true">#</a> Trend GET</h4><p>For getting Trend from server, the <strong>Json</strong> format is:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">67</span><span class="token punctuation">,</span>
        <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A tired day however tasty supper!&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;location&quot;</span><span class="token operator">:</span> <span class="token string">&quot;[114.186066,22.304198]&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;post_time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-11-22 05:58:26&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;pic_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hanjiaming3@Tue-Nov-22-05:58:25-CST-2022&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hanjiaming3&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">66</span><span class="token punctuation">,</span>
        <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A Good day with my friend!&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;location&quot;</span><span class="token operator">:</span> <span class="token string">&quot;[114.18640739,22.30454971]&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;post_time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-11-22 05:38:51&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;pic_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hanjiaming@Tue-Nov-22-05:38:50-CST-2022&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HanJiaming&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    ......
<span class="token punctuation">]</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="upload-post" tabindex="-1"><a class="header-anchor" href="#upload-post" aria-hidden="true">#</a> Upload POST</h4><p>For <strong>HTTP POST request</strong>, the format is as follows:</p><div class="language-ht ext-ht line-numbers-mode"><pre class="language-ht"><code>POST comp4342.hjm.red:8044 HTTP/1.1 
Content-Type: application/json;charset=utf-8

{&quot;user&quot;: &quot;hanjiaming&quot;, 
 &quot;identifier&quot;: &quot;fnr4f34g7bjb4hr&quot;, 
 &quot;message&quot;:&quot;A rainy Day&quot;, 
 &quot;location&quot;:&quot;[28,32]&quot;,
 &quot;picture&quot;: &quot;rf3rfuy845nt7457tcnv4&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>For <strong>HTTP response</strong>, the format is as follows:</p><div class="language-ht ext-ht line-numbers-mode"><pre class="language-ht"><code>{
    &quot;statue&quot;:&quot;Success&quot;,
    &quot;commit&quot;:&quot;No error&quot;,
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="volley" tabindex="-1"><a class="header-anchor" href="#volley" aria-hidden="true">#</a> Volley</h3><p><strong>Volley</strong> is an HTTP library that makes networking for Android apps <strong>easier</strong> and most <strong>importantly</strong>, faster.</p><p>We have implemented a previous version of HTTP parser, however, this library offers the following <strong>advantages</strong>, rather than implementing HTTP parser by ourselves:</p><ul><li><strong>Automatic</strong> scheduling of network requests,</li><li>Multiple <strong>concurrent</strong> network connections,</li><li>Transparent disk and memory response <strong>caching</strong> with standard HTTP cache coherence,</li><li>Support for request *<strong>prioritization</strong>,</li><li><strong>Debugging and tracing</strong> tools.</li></ul><p>Below is part of our implementation by making use of this Volley tool to make our development <strong>faster</strong> and <strong>more</strong> <strong>robust</strong>:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token class-name">StringRequest</span> stringRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRequest</span><span class="token punctuation">(</span><span class="token class-name">Request<span class="token punctuation">.</span>Method</span><span class="token punctuation">.</span>POST<span class="token punctuation">,</span> <span class="token string">&quot;https://comp4342.hjm.red/login&quot;</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">Response<span class="token punctuation">.</span>Listener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">Response<span class="token punctuation">.</span>ErrorListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onErrorResponse</span><span class="token punctuation">(</span><span class="token class-name">VolleyError</span> volleyError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        progressDialog<span class="token punctuation">.</span><span class="token function">dismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Networking Error&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span> 
<span class="token punctuation">)</span>                                            
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="smart-client-design" tabindex="-1"><a class="header-anchor" href="#smart-client-design" aria-hidden="true">#</a> Smart Client design</h2><h3 id="serverpostmodel" tabindex="-1"><a class="header-anchor" href="#serverpostmodel" aria-hidden="true">#</a> ServerPostModel</h3><p>This <strong>ServerPostModel</strong> Class is to get information from the post retrieved on server side, including fields as follows:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServerPostMeta</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> identifier<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> location<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> picture<span class="token punctuation">;</span>
    
    <span class="token comment">// methods</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="clientpostmodel" tabindex="-1"><a class="header-anchor" href="#clientpostmodel" aria-hidden="true">#</a> ClientPostModel</h3><p>This <strong>ClientPostModel</strong> Class is to build post on client side, including fields as follows:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClientPostMeta</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> post_time<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> location<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> pic_name<span class="token punctuation">;</span>
    
    <span class="token comment">// methods</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-userinfomodel" tabindex="-1"><a class="header-anchor" href="#_5-3-userinfomodel" aria-hidden="true">#</a> 5.3 UserInfoModel</h3><p>This <strong>ClientPostModel</strong> Class is to get user information on client side, including fields as follows:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserInfo</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
    
    <span class="token comment">// methods</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="local-sqlite-database" tabindex="-1"><a class="header-anchor" href="#local-sqlite-database" aria-hidden="true">#</a> Local SQLite database</h3><p>Most application logic of the <strong>GEM</strong> Client is achieved on server side, however, some <strong>frequently required information</strong> are also stored locally on client side. There are in total two types of information stored in Datebase in the whole system: The <strong>posts</strong> and the <strong>profiles</strong>.</p><p>Smart client can store its profile information in its <strong>Local SQLite database</strong> via <strong>DBController</strong>, which is a local database opening and upgrading controller: It uniquely and permenantly stores the local user information, which is a common method similar to <strong>caching implementation</strong>.</p><p>During the use of application, network connection may <strong>frequently checks</strong> user&#39;s identity, so that it is convenient &amp; required to store the user information locally.</p><p>The identifier is equivalent to a token, and serves as the user&#39;s login credentials.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">SQLiteDatabase</span> db<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Create local SQL table</span>
        <span class="token class-name">String</span> table <span class="token operator">=</span> <span class="token string">&quot;create table user(id int,username varchar(13), password varchar(13), identifier varchar(65),locationX varchar(63), locationY varchar(63))&quot;</span><span class="token punctuation">;</span>
        db<span class="token punctuation">.</span><span class="token function">execSQL</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="server-side-design" tabindex="-1"><a class="header-anchor" href="#server-side-design" aria-hidden="true">#</a> Server Side Design</h2><p>The server is developed based on the Spring Web framework.</p><ul><li>Building: Maven</li><li>Programming Language: Java (Language Level 17)</li><li>JDK: 17</li><li>Deploy Platform: Linux hssvr03 3.10.0-1160.53.1.el7.x86_64 GNU/Linux</li><li>Package: Executable Jar</li></ul><p><img src="https://static-file.hjm.red/2022/11/22/89f49ab15833e.jpg" alt="76211669111956_.pic.jpg" loading="lazy"></p><ul><li>The server program is divided into three layers, which is the controller, DAO, and model. The controller is implemented by the GEMController in a REST style, which creates RESTful web services. GEMController handles HTTP requests from the client application and returns appropriate response or data. The endpoints are shown as follows.</li></ul><p><img src="https://static-file.hjm.red/2022/11/22/45ec59b06dbab.png" alt="WechatIMG7664.png" loading="lazy"></p><ul><li><p>The DAO (Data Access Objects) is implemented by MySQLRepository. MySQLRepository implements several SQL query and update functions. In details, the server uses &quot;com.mysql:mysql-connector-j:8.0.31&quot; to connect mySQL database and jdbcTemplate for executing SQL statements.</p></li><li><p>The model includes three classes. Post and User follow the database design, and are used within the server for objects passing. Response is a designed class that is used for returning 3-state HTTP responses to the client program. The three states are SUCCESS, FAIL, and BAD (for invalid request only).</p></li><li><p>During the server developing, the programmer adopts &quot;defensive-programming&quot; style to make the server more robust and safe. That is, malicious requests will not break the whole server. And multi-thread model is embedded inside the Spring framework, so it could handle large amount of requests simultaneously.</p></li></ul><h2 id="database-design" tabindex="-1"><a class="header-anchor" href="#database-design" aria-hidden="true">#</a> Database Design</h2><p>The back-end uses mySQL as the data storage.</p><ul><li>userinfo: id(auto-generated by mySQL), username, password, identifier(session cookie), enable(blocked or not)</li><li>post: id(auto-generated by mySQL), user_id(the poster&#39;s id), message, location, post_time, pic_name.</li></ul><p><img src="https://static-file.hjm.red/2022/11/22/7a62b612f8fa1.jpg" alt="47461669060631_.pic.jpg" loading="lazy"></p><h2 id="advanced-features-benefits" tabindex="-1"><a class="header-anchor" href="#advanced-features-benefits" aria-hidden="true">#</a> Advanced Features &amp; Benefits</h2><h3 id="mobility-network-transport-optimization" tabindex="-1"><a class="header-anchor" href="#mobility-network-transport-optimization" aria-hidden="true">#</a> Mobility: Network Transport Optimization</h3><p>The client converts the image to base64 before sending it to the server. Compressing the file helps to reduce the pressure of network transmission.</p><p>The server side also uses file compression to provide both thumbnail and original image references for the client, reducing traffic.</p><h3 id="location-based-service" tabindex="-1"><a class="header-anchor" href="#location-based-service" aria-hidden="true">#</a> Location-based service</h3><p>GEM uses a converged location service that determines the user&#39;s geographic location through a combination of GPS and mobile networks. When the application opens, it will first use network services to obtain geographic location faster, and then use GPS and other satellite services to obtain and update more accurate geographic location periodically.</p><h3 id="security-management" tabindex="-1"><a class="header-anchor" href="#security-management" aria-hidden="true">#</a> Security Management</h3><p>HTTPS adds a layer of SSL/TLS (Secure Sockets Layer/Transport Layer Security) between traditional HTTP and TCP for encryption and decryption.</p><p>The client transmits data to the server using the public key for encryption and the private key for decryption on the server side. This process can achieve secure transmission.</p><h3 id="ai-recommendation-system-of-posts-concept" tabindex="-1"><a class="header-anchor" href="#ai-recommendation-system-of-posts-concept" aria-hidden="true">#</a> AI recommendation system of posts (Concept)</h3><p>We have implemented an AI recommendation algorithm and <strong>rating mechanism</strong> on server side, so that system will be able to push the posts trend according to the <strong>user interest</strong>.</p><p><strong>AI recommendation sorted by rating:</strong> All the posts are sorted according to their rating to this specific user.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientPostMeta</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">AI_recommendation</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientPostMeta</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">PostList</span><span class="token punctuation">,</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientPostMeta</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">UserPostList</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// default to 0</span>
        <span class="token comment">// Calculate &quot;feature similarity&quot;</span>
        <span class="token comment">// Sort by &quot;feature similarity&quot;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Objects</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token class-name">MapUtil</span><span class="token punctuation">.</span><span class="token function">sortByValue</span><span class="token punctuation">(</span><span class="token class-name">AI_rating</span><span class="token punctuation">(</span><span class="token class-name">PostList</span><span class="token punctuation">,</span> <span class="token class-name">UserPostList</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">)</span>result<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Content-based filtering:</strong> The approaches utilize a series of discrete, pre-tagged characteristics of an item in order to recommend additional items with similar properties. In our setting, AI rating is calculated as the <strong>average of similarity score</strong> of the specific <strong>post message</strong> with all the posts message of the specific user.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientPostMeta</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">AI_rating</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientPostMeta</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">PostList</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientPostMeta</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">UserPostList</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// default to 0</span>
        <span class="token comment">// Calculate rating based on Content-based filtering</span>
        <span class="token comment">// Based on content similarity average</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientPostMeta</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ClientPostMeta</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ClientPostMeta</span> post<span class="token operator">:</span> <span class="token class-name">PostList</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">int</span> rating_sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ClientPostMeta</span> userPost<span class="token operator">:</span> <span class="token class-name">UserPostList</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                rating_sum <span class="token operator">+=</span> <span class="token class-name">StringSimilarity</span><span class="token punctuation">.</span><span class="token function">similarity</span><span class="token punctuation">(</span>post<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> userPost<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>post<span class="token punctuation">,</span> rating_sum<span class="token operator">/</span><span class="token class-name">UserPostList</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Levenshtein Edit Distance:</strong> This distance is used for calculating the similary of the two strings, which is calculated between a post message and another post message in our setting.</p><p><img src="https://static-file.hjm.red/2022/11/22/f209344509202.png" alt="1669099607067.png" loading="lazy"></p><p>Figure. Levenshtein Edit Distance Formula</p><p>Although this is only a concept, in the future we will deploy and continuously improve.</p><h2 id="testing-strategies" tabindex="-1"><a class="header-anchor" href="#testing-strategies" aria-hidden="true">#</a> Testing strategies</h2><p>The development of the GEM client follows Google&#39;s instructions. Iterative development of a feature can begin by writing a new test or by adding use cases and assertions to an existing unit test. Tests will initially fail because the feature has not yet been implemented.</p><p><img src="https://static-file.hjm.red/2022/11/22/9d027e26b74ae.png" alt="1669117280144.png" loading="lazy"></p><p>Figure. Two cycles associated with test-driven iterative development</p><p>Our test scenarios include</p><ul><li>Virtual machine testing: occurs during development and debugging.</li><li>Real Equipment Testing: Investigate the operation of the program on different models of cell phones.</li></ul><p>In the real device&#39;s, developers tried brute force requests and random touch presses to test the stability of the application and discover new problems.</p>`,149),i=[o];function r(l,p){return s(),e("div",null,i)}var u=n(t,[["render",r],["__file","report.html.vue"]]);export{u as default};
